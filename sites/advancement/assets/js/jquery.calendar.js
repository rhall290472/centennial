/*
 *	jQuery FullCalendar Extendable Plugin
 *	An Ajax (PHP - Mysql - jquery) script that extends the functionalities of the fullcalendar plugin
 *  Dependencies:
 *   - jquery
 * 	 - jquery spectrum
 *   - flatpickr
 *   - fullcalendar 5
 *   - Bootstrap 5
 *  Author: Paulo Regina
 *  Website: www.pauloreg.com
 *  Fullcalendar minimum supported version: 5.10
 *  Fullcalendar Stable 6.1.11
 *	Released Under Envato Regular or Extended Licenses
 */

!function(e,t){e.fn.extend({FullCalendarExt:function(a){var o="token="+e("#cal_token").val(),n=Intl.DateTimeFormat().resolvedOptions().timeZone,l={calendarSelector:"#calendar",loadingSelector:"#loading",lang:"en",token:"",timezone:n,ajaxJsonFetch:"assets/includes/cal_events.php?"+o+"&timezone="+n,ajaxUiUpdate:"includes/cal_update.php?"+o+"&timezone="+n,ajaxEventQuickSave:"includes/cal_quicksave.php?"+o+"&timezone="+n,ajaxEventEdit:"includes/cal_edit_update.php?"+o+"&timezone="+n,ajaxEventDelete:"includes/cal_delete.php?"+o,ajaxEventExport:"includes/cal_export.php?"+o,ajaxRepeatCheck:"includes/cal_check_rep_events.php?"+o,ajaxRetrieveDescription:"assets/includes/cal_description.php?"+o,ajaxImport:"importer.php?"+o+"&timezone="+n,jsonConfig:"assets/includes/form.json",ajaxLoader:"assets/includes/loader.php",modalSelector:"#calendarModal",modalPromptSelector:"#cal_prompt",modalEditPromptSelector:"#cal_edit_prompt_save",formAddEventSelector:"form#add_event",formFilterSelector:"form#filter-category select",formSearchSelector:"form#search",newEventText:"Add New Event",successAddEventMessage:"Successfully Added Event",successDeleteEventMessage:"Successfully Deleted Event",successUpdateEventMessage:"Successfully Updated Event",failureAddEventMessage:"Failed To Add Event",failureDeleteEventMessage:"Failed To Delete Event",failureUpdateEventMessage:"Failed To Update Event",generalFailureMessage:"Failed To Execute Action",ajaxError:"Failed to load content",emptyForm:"Form cannot be empty",unableToOpenEvent:"Something went wrong. Unable to open event",eventText:"Event: ",selectDateText:"Select date",repetitiveEventActionText:"This is a repetitive event, what do you want to do?",goToLabel:"goto",todayLabel:"today",monthLabel:"month",weekLabel:"week",dayLabel:"day",listLabel:"list",direction:"ltr",weekText:"W",defaultColor:"#587ca3",weekType:"timeGridWeek",dayType:"timeGridDay",listType:"listWeek",titleRangeSeparator:" â€“ ",tooltip:!1,editable:!0,lazyFetching:!0,filter:!0,quickSave:!0,navLinks:!0,firstDay:0,gcal:!1,gcalUrlText:"View on Google",version:"modal",initialView:"dayGridMonth",aspectRatio:1.35,weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",hiddenDays:[],themeSystem:"standard",eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!1},fixedWeekCount:!0,allDaySlot:!0,slotDuration:"00:30:00",slotMinTime:"00:00:00",slotMaxTime:"24:00:00",nextDayThreshold:"00:00:00",slotEventOverlap:!0,displayEventEnd:!0,enableDrop:!0,enableResize:!0,savedRedirect:"index.php",removedRedirect:"index.php",updatedRedirect:"index.php",ajaxLoaderMarkup:'<div class="loadingDiv"></div>',otherSource:!1,modalFormBody:e("#modal-form-body").html(),icons_title:!1,fc_extend:{},polling:!0,pollingInt:30,dayMaxEventRows:!0,moreLinkClick:"popover",palette:[["#0b57a4","#8bbdeb","#000000","#2a82d7","#148aa5","#3714a4","#587ca3","#a50516"],["#fb3c8f","#1b4f15","#1b4f15","#686868","#3aa03a","#ff0080","#fee233","#fc1cad"],["#7f2b14","#000066","#2b4726","#fd7222","#fc331c","#af31f2","#fc0d1b","#2b8a6d"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"]]},i=e.extend(l,a),d={},r={locale:i.lang,editable:i.editable,dayMaxEventRows:i.dayMaxEventRows,moreLinkClick:i.moreLinkClick,navLinks:i.navLinks,initialView:i.initialView,aspectRatio:i.aspectRatio,weekends:i.weekends,weekNumbers:i.weekNumbers,weekNumberCalculation:i.weekNumberCalculation,weekText:i.weekText,direction:i.direction,hiddenDays:i.hiddenDays,themeSystem:i.themeSystem,allDaySlot:i.allDaySlot,slotDuration:i.slotDuration,slotMinTime:i.slotMinTime,slotMaxTime:i.slotMaxTime,slotEventOverlap:i.slotEventOverlap,fixedWeekCount:i.fixedWeekCount,eventTimeFormat:i.eventTimeFormat,headerToolbar:{start:"prev,next today goTo",center:"title",end:"dayGridMonth,"+i.weekType+","+i.dayType+","+i.listType},titleRangeSeparator:i.titleRangeSeparator,monthNames:i.monthNames,monthNamesShort:i.monthNamesShort,dayNames:i.dayNames,dayNamesShort:i.dayNamesShort,buttonText:{today:i.todayLabel,month:i.monthLabel,week:i.weekLabel,day:i.dayLabel,list:i.listLabel},firstDay:i.firstDay,lazyFetching:i.lazyFetching,selectable:i.quickSave,selectMirror:i.quickSave,eventStartEditable:i.enableDrop,eventDurationEditable:i.enableResize,nextDayThreshold:i.nextDayThreshold,displayEventEnd:i.displayEventEnd,loading:function(t){0==t?e(i.loadingSelector).hide():1==t&&e(i.loadingSelector).show()},select:function(t){let a=t.view;t.resource&&t.resource.id?d.resource=t.resource.id:d.resource=0,d.view=a.type;let o=t.start,n=t.end;calendar.view=a.type,"modal"==i.version&&(calendar.quickModal(o,n,t.allDay),m.unselect()),"dayGridMonth"!==a.type&&moment(o).format("HH:mm")!==moment(n).format("HH:mm")&&(e('#event-type option[value="false"]').prop("selected",!0),e("#event-type-select").show(),e("#event-type-selected").show())},eventSources:[i.otherSource,{url:i.ajaxJsonFetch}],eventDrop:function(e){p(e)},eventResize:function(e){p(e)},eventDidMount:function(t){let a=e(t.el),o=t.event._def;t.view;if(i.tooltip)new bootstrap.Tooltip(t.el,{title:o.title,placement:"top",trigger:"hover",container:"body"});if(a.attr("href"))a.attr("data-toggle","modal"),a.attr("href","javascript:void(0)"),a.attr("onclick",'calendar.openModalGcal("'+encodeURIComponent(o.title)+'","'+encodeURIComponent(o.url)+'");');else{if(1==i.icons_title){var n=a.find(".fc-title").text().replace(/\[(.*?)\]/gi,'<i class="$1"></i>');a.find(".fc-title").html(n)}var l=o.ui.backgroundColor,d=moment(o.extendedProps.utcStart).format("YYYY-MM-DD"),r=moment(o.extendedProps.utcStart).format("HH:mm"),c=moment(o.extendedProps.utcEnd).format("YYYY-MM-DD"),s=moment(o.extendedProps.utcEnd).format("HH:mm");if(0==moment(o.extendedProps.utcEnd).isValid())c=d,s=r;a.attr("data-eventstart",o.extendedProps.utcStart),a.attr("data-eventend",o.extendedProps.utcEnd),a.attr("data-d_startdate",d),a.attr("data-d_starttime",r),a.attr("data-d_enddate",c),a.attr("data-d_endtime",s),"modal"==i.version&&(a.attr("data-toggle","modal"),a.attr("href","javascript:void(0)"),a.attr("data-id",o.publicId),a.attr("data-rep_id",o.extendedProps.original_id),a.attr("data-title",encodeURIComponent(o.title)),a.attr("data-url",encodeURIComponent(o.url)),a.attr("data-color",l),a.attr("onclick","calendar.openModal(this)"))}Object.freeze(calendar)},eventClick:function(t){e(i.loadingSelector).show()},customButtons:{goTo:{text:i.goToLabel,click:function(){if(e("#gotodate-wrap").length<=0){var t=new Date;e("body").append(`\n\t\t\t\t\t\t\t\t\t<div id="gotodate-wrap" class="modal" tabindex="-1" role="dialog">\n\t\t\t\t\t\t\t\t\t  <div class="modal-dialog" role="document">\n\t\t\t\t\t\t\t\t\t\t<div class="modal-content">\n\t\t\t\t\t\t\t\t\t\t  <div class="modal-header">\n\t\t\t\t\t\t\t\t\t\t\t<h5 class="modal-title">${i.selectDateText}</h5>\n\t\t\t\t\t\t\t\t\t\t\t<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n\t\t\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t\t\t\t  <div class="modal-body">\n\t\t\t\t\t\t\t\t\t\t\t<p><input type="text" id="gotodate" /></p>\n\t\t\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t`)}setTimeout((function(){e("#gotodate-wrap").modal("show"),e("#gotodate").flatpickr({enableTime:!1,defaultDate:t,altInput:!0,onChange:function(e,a,o){m.gotoDate(e[0]),t=e[0]}})}),500)}}}},c=e.extend(r,i.fc_extend),s=document.querySelector(i.calendarSelector),m=new FullCalendar.Calendar(s,c);m.render(),i.polling&&setInterval((function(){m.refetchEvents()}),1e3*i.pollingInt),calendar.openModal=function(a){d.id=e(a).data("id"),d.rep_id=e(a).data("rep_id"),d.title=e(a).data("title"),d.url=e(a).data("url"),d.eventStart=e(a).data("eventstart"),d.eventEnd=e(a).data("eventend"),d.color=e(a).data("color"),d.d_startDate=e(a).data("d_startdate"),d.d_startTime=e(a).data("d_starttime"),d.d_endDate=e(a).data("d_enddate"),d.d_endTime=e(a).data("d_endtime"),1==i.icons_title?(d.title=d.title.replace(/\[(.*?)\]/gi,'<i class="$1"></i>'),d.title=decodeURIComponent(d.title)):d.title=decodeURIComponent(d.title),e("#modal-form-body").hide(),e("#details-body").show(),e("#details-body-content").html(""),d.ExpS=d.eventStart,d.ExpE=d.eventEnd,e.ajax({type:"POST",url:i.ajaxRetrieveDescription,data:{id:d.id,title:encodeURIComponent(d.title),start:d.d_startDate,mode:"edit"},cache:!1,beforeSend:function(){e(".loadingDiv").show(),e(".modal-footer").hide()},error:function(){e(".loadingDiv").hide(),console.log(i.ajaxError)},success:function(a){if(e(i.loadingSelector).hide(),a){e(".loadingDiv").hide();var o=JSON.parse(a),n=o.description.replace("$null",""),l=o.color.replace("$null",""),r=o.category.replace("$null","");d.description_editable=o.description_editable.replace("&amp;","&"),d.description=n.replace("&amp;","&"),d.category=r.replace("&amp;","&"),d.color=l,d.data=o;var c=JSON.parse(JSON.stringify(o));e("#details-body-title").html(d.title),function(a,o){b(o,["all-day","categorie","categories","category","color","description","description_editable","end","start","id","repeat_id","repeat_type","title","url","user_id","timezone","resourceId"]);var n="";e.getJSON(i.jsonConfig,{_:(new Date).getHours()}).then((function(l){if(e(".custom-fields").children().length>0&&Object.keys(o).length>0)for(var i in Object.keys(o).every((function(e){return""===o[e]||null===o[e]}))||(n="<hr />"),o){var d=o[i],r=[];"file"==i&&(d=d!==t&&"undefined"!==d&&""!==d?/\.(gif|jpg|jpeg|tiff|png)$/i.test(d)?'<a target="_blank" href="'+d+'"><img src="'+d+'" class="img-responsive" /></a>':'<a target="_blank" href="'+d+'">'+d+"</a>":"");var c=x(l,"<"+i+">");if(d.length>0||e.isArray(d)&&null!==d)if(e.isArray(d)&&null!==d){for(var s=0;s<d.length;s++)r.push(E(l,d[s]));n+='<h5 class="cf-'+i+'"><strong>'+c+"</strong></h5><p>"+r.join(", ")+'</p><p class="custom-field-sep" style="margin-bottom: 0; height: 2px;">&nbsp;</p>'}else d&&(n+='<h5 class="cf-'+i+'"><strong>'+c+"</strong></h5><p>"+d+'</p><p class="custom-field-sep" style="margin-bottom: 0; height: 2px;">&nbsp;</p>')}e("#details-body-content").html(a+n)})).fail((function(){e("#details-body-content").html(a)}))}(n,c),e("#export-event, #delete-event, #edit-event").show(),e("#save-changes, #add-event").hide(),e(".modal-footer").show(),e(i.modalSelector).modal("show")}else alert(i.unableToOpenEvent)}}),e("#delete-event").off().on("click",(function(e){h(d.id),e.preventDefault()})),e("#export-event").off().on("click",(function(e){g(d.id,d.title,d.ExpS,d.ExpE),e.preventDefault()})),e("#edit-event").off().on("click",(function(a){document.getElementById("modal-form-body").reset(),e("#modal-form-body").html(i.modalFormBody),e("#export-event, #delete-event, #edit-event, #add-event").hide(),e("#save-changes").show().css("width","100%"),e("#details-body, #event-type-select").hide(),e("#repeat-type-select, #repeat-type-selected").hide(),e("#event-type-selected").show(),e("#modal-form-body").show(),e(i.modalSelector).modal("show"),e("#modal-form-body :input").each((function(){var a=e(this).attr("name");switch(e(this)[0].tagName){case"SELECT":(n=d.data[a])!==t&&e('#modal-form-body option[value="'+n.replace("&amp;","&")+'"]').prop("selected",!0),"categorie"==n&&e('#modal-form-body option[value="'+n.replace("&amp;","&")+'"]').prop("selected",!0);break;case"INPUT":a=a.replace(/\[.*?\]/g,"");var o=e(this).attr("type"),n=d.data[a];if("checkbox"==o&&n!==t)for(var l=n,i=0;i<l.length;i++)e('#modal-form-body input[value="'+l[i]+'"]').prop("checked",!0);"radio"==o&&n!==t&&e('#modal-form-body input[value="'+n+'"]').prop("checked",!0),"file"==o&&n!==t&&"undefined"!==n&&e(this).before('<p class="file-attachment"><a target="_blank" href="'+n+'">'+n+"</a></p>"),"text"==o&&(e('#modal-form-body input[name="'+a+'"]').val(d.data[a]),e("#modal-form-body input[name=title]").val(d.data.title),setTimeout((function(){e("#colorp").spectrum("set",d.data.color)}),50),e("#startDate").val(d.d_startDate),e("input#startTime").val(d.d_startTime),e("#endDate").val(d.d_endDate),e("input#endTime").val(d.d_endTime));break;case"TEXTAREA":n=d.data[a],e('textarea[name="'+a+'"]').val(n),e('textarea[name="description"]').val(d.data.description_editable);break;default:e(':input[name="'+a+'"]').val(d.data[a])}})),e("#save-changes").off().on("click",(function(a){if(0==e("input[name=title]").val().length)alert(i.emptyForm);else{editFormData=new FormData;var o=e("#modal-form-body").serializeArray();e.each(o,(function(t,a){if(e.isArray(a.value))for(var o=0;o<a.value.length;o++)editFormData.append(a.name+"[]",a.value[o]);else editFormData.append(a.name,a.value)}));var n=e("#modal-form-body").find("input[type=checkbox]");e.each(n,(function(t,a){e(this).is(":checked")||editFormData.append(e(a).attr("name"),"")})),e("#file")[0]&&e("#file")[0].files[0]!==t&&"undefined"!==e("#file")[0].files[0]&&editFormData.append("file",e("#file")[0].files[0]);flatpickr("#startDate").input.value,flatpickr("#startTime",{allowInput:!0,dateFormat:"H:i",enableTime:!0,noCalendar:!0,time_24hr:!0}).input.value,flatpickr("#endDate").input.value,flatpickr("#endTime",{allowInput:!0,dateFormat:"H:i",enableTime:!0,noCalendar:!0,time_24hr:!0}).input.value;editFormData.set("timezone",i.timezone),f(d.id,editFormData)}a.preventDefault()}))}))},calendar.data=function(){return{id:d.id,title:d.title,url:d.url,start:d.eventStart,end:d.eventEnd,description:d.description,color:d.color}},calendar.openModalGcal=function(t,a){e("#modal-form-body").hide(),e("#details-body").show(),e("#details-body-title").html(decodeURIComponent(t)),e("#details-body-content").html('<a target="_blank" href="'+decodeURIComponent(a)+'">'+i.gcalUrlText+"</a>"),e("#export-event, #delete-event, #edit-event").hide(),e("#save-changes, #add-event").hide(),e(".modal-footer").hide(),e(i.modalSelector).modal("show")},calendar.quickModal=function(t,a,o){document.getElementById("modal-form-body").reset(),e("#modal-form-body").html(i.modalFormBody);var n=moment(t).format("YYYY-MM-DD"),l=moment(t).format("HH:mm"),r=moment(a).format("YYYY-MM-DD"),c=moment(a).format("HH:mm");if("dayGridMonth"==d.view&&(r=moment(a).subtract(1,"days").format("YYYY-MM-DD")),0!==d.resource&&e('input[name="resourceId"]').val(d.resource),0==moment(a).isValid())r=n,c=l;e("#startDate").val(n),e("#startTime").val(l),e("#endDate").val(r),e("#endTime").val(c),e("#details-body").hide(),e("#event-type-select").show(),e("#event-type-selected").hide(),e("#repeat-type-select").show(),e("#repeat-type-selected").hide(),e("#export-event, #delete-event, #edit-event, #save-changes").hide(),e("#add-event").show().css("width","100%"),e(".modal-footer").show(),e("#modal-form-body").show(),e("#details-body-title").html(i.newEventText),e(i.modalSelector).modal("show"),e("#event-type").on("change",(function(){var t=e(this).val();"false"==t?(e("#event-type-select").show(),e("#event-type-selected").show()):"true"==t&&(e("#event-type-select").show(),e("#event-type-selected").hide())})),e("#repeat_select").on("change",(function(){var t=e(this).val();"no"!==t?(e("#repeat-type-select").show(),e("#repeat-type-selected").show()):"no"==t&&(e("#repeat-type-select").show(),e("#repeat-type-selected").hide())})),e("#colorp").spectrum("set",i.defaultColor),e("#add-event").off().on("click",(function(t){if(0==e("input[name=title]").val().length)alert(i.emptyForm);else{formData=new FormData(e("#modal-form-body").get(0)),e("#file")[0]&&formData.append("file",e("#file")[0].files[0]);flatpickr("#startDate").input.value,flatpickr("#startTime",{allowInput:!0,dateFormat:"H:i",enableTime:!0,noCalendar:!0,time_24hr:!0}).input.value,flatpickr("#endDate").input.value,flatpickr("#endTime",{allowInput:!0,dateFormat:"H:i",enableTime:!0,noCalendar:!0,time_24hr:!0}).input.value;formData.set("timezone",i.timezone),u(formData)}t.preventDefault()}))};var p=function(a){e(a.el);let o=a.event._def,n=a.event._instance.range;moment(n.start).utc().format("YYYY-MM-DD HH:mm"),moment(n.end).utc().format("YYYY-MM-DD HH:mm");var l=moment(n.start).utc().format("YYYY-MM-DD"),d=moment(n.start).utc().format("HH:mm"),r=moment(n.end).utc().format("YYYY-MM-DD"),c=moment(n.end).utc().format("HH:mm"),s=moment(n.end).isValid();null===n.end||"null"===n.end||0==s?(Eend=l+" "+d,EaD="false"):(Eend=r+" "+c,EaD=o.allDay);let p=0;o.resourceIds!==t&&null!==o.resourceIds&&(p=o.resourceIds[0]);var u="title="+encodeURIComponent(o.title)+"&start="+l+" "+d+"&end="+Eend+"&id="+o.publicId+"&allDay="+EaD+"&timezone="+i.timezone+"&original_id="+o.extendedProps.original_id+"&resourceId="+p;e.post(i.ajaxUiUpdate,u,(function(e){m.refetchEvents()}))},u=function(t){e.ajax({url:i.ajaxEventQuickSave,data:t,type:"POST",cache:!1,processData:!1,contentType:!1,beforeSend:function(){e(".loadingDiv").show(),e(".modal-footer").hide()},error:function(){e(".loadingDiv").hide(),console.log(i.ajaxError)},success:function(t){e(".loadingDiv").hide(),1==t?(e(i.modalSelector).modal("hide"),m.refetchEvents()):(alert(i.failureAddEventMessage),e(".modal-footer").show())}})},f=function(t,a){var o="id="+t;e.ajax({type:"POST",url:i.ajaxRepeatCheck,data:o,cache:!1,beforeSend:function(){e(".loadingDiv").show()},error:function(){e(".loadingDiv").hide(),console.log(i.ajaxError)},success:function(o){e(".loadingDiv").hide(),"REP_FOUND"==o?(e(i.modalSelector).modal("hide"),e(i.modalEditPromptSelector+" .modal-header").html("<h4>"+i.eventText+d.title+"</h4>"),e(i.modalEditPromptSelector+" .modal-body-custom").css("padding","15px").html(i.repetitiveEventActionText),e(i.modalEditPromptSelector).modal("show"),e('[data-option="save-this"]').unbind("click").on("click",(function(o){v(t,a),e(i.modalEditPromptSelector).modal("hide"),e(i.modalSelector).modal("hide"),o.preventDefault()})),e('[data-option="save-repetitives"]').unbind("click").on("click",(function(o){v(t,a,"true"),e(i.modalEditPromptSelector).modal("hide"),e(i.modalSelector).modal("hide"),o.preventDefault()}))):v(t,a)},error:function(e){alert(i.generalFailureMessage)}})},v=function(a,o,n){n===t?editFormData.append("id",a):(editFormData.append("id",a),editFormData.append("rep_id",d.rep_id),editFormData.append("method","repetitive_event")),editFormData.append("otitle",d.title),e.ajax({type:"POST",url:i.ajaxEventEdit,data:o,cache:!1,processData:!1,contentType:!1,beforeSend:function(){e(".loadingDiv").show()},error:function(){e(".loadingDiv").hide(),console.log(i.ajaxError)},success:function(t){e(".loadingDiv").hide(),""==t?(e(i.modalSelector).modal("hide"),m.refetchEvents()):alert(i.failureUpdateEventMessage)},error:function(e){alert(i.failureUpdateEventMessage)}})},h=function(t){var a="id="+t;e.ajax({type:"POST",url:i.ajaxRepeatCheck,data:{id:t},cache:!1,beforeSend:function(){e(".loadingDiv").show()},error:function(){e(".loadingDiv").hide(),console.log(i.ajaxError)},success:function(o){e(".loadingDiv").hide(),"REP_FOUND"==o?(e(i.modalSelector).modal("hide"),e(i.modalPromptSelector+" .modal-header").html("<h4>"+i.eventText+d.title+"</h4>"),e(i.modalPromptSelector+" .modal-body").html(i.repetitiveEventActionText),e(i.modalPromptSelector).modal("show"),e('[data-option="remove-this"]').unbind("click").on("click",(function(t){y(a),e(i.modalPromptSelector).modal("hide"),t.preventDefault()})),e('[data-option="remove-repetitives"]').unbind("click").on("click",(function(a){var o="id="+t+"&rep_id="+d.rep_id+"&method=repetitive_event&delete=yes";y(o),e(i.modalPromptSelector).modal("hide"),a.preventDefault()}))):y(a)},error:function(e){alert(i.generalFailureMessage)}})},y=function(t){var a=t+"&title="+encodeURIComponent(d.title)+"&start="+d.d_startDate;e.ajax({type:"POST",url:i.ajaxEventDelete,data:a,cache:!1,beforeSend:function(){e(".loadingDiv").show()},error:function(){e(".loadingDiv").hide(),console.log(i.ajaxError)},success:function(t){e(".loadingDiv").hide(),""==t?(e(i.modalSelector).modal("hide"),m.refetchEvents()):alert(i.failureDeleteEventMessage)}})},g=function(e,t,a,o){var n=a,l=o,d="&method=export&id="+encodeURIComponent(e)+"&title="+encodeURIComponent(t)+"&start_date="+encodeURIComponent(n)+"&end_date="+encodeURIComponent(l);window.location=i.ajaxEventExport+d};calendar.calendarImport=function(){txt="import="+encodeURIComponent(e("#import_content").val()),e.post(i.ajaxImport,txt,(function(t){alert(t),m.refetchEvents(),e("#cal_import").modal("hide"),e("#import_content").val("")}))};var b=function(e,t){for(var a=0;a<t.length;a++)e.hasOwnProperty(t[a])&&delete e[t[a]]};if(1==i.filter){function D(){value=e(i.formSearchSelector+" input").val(),construct="search="+encodeURIComponent(value),e.post(i.ajaxLoader,construct,(function(e){m.refetchEvents()}))}e(i.formFilterSelector).on("change",(function(t){selected_value=e(this).val(),construct="filter="+encodeURIComponent(selected_value),e.post(i.ajaxLoader,construct,(function(e){m.refetchEvents()})),t.preventDefault()})),e(i.formSearchSelector).keypress((function(e){13==e.which&&(D(),e.preventDefault())})),e(i.formSearchSelector+" button").on("click",(function(e){D()})),window.onbeforeunload=function(){var t=new FormData;t.append("search",""),t.append("filter",e(i.formFilterSelector+" option:selected").val()),navigator.sendBeacon(i.ajaxLoader,t)}}function x(e,t){var a="";for(var o in e)if(e.hasOwnProperty(o)){var n=e[o].fields;for(var l in n)n.hasOwnProperty(l)&&Object.keys(n).forEach((function(e){if(!n[e].includes(t)&&!n[e].includes(t.replace(">","[]>")))return!1;a=e}))}return a}function E(e,t){var a=[];for(var o in e)e.hasOwnProperty(o)&&("object"==typeof e[o]?a=a.concat(E(e[o],t)):o==t&&a.push(e[o]));return a}e(i.modalSelector).on("hidden.bs.modal",(function(t){e("#details-body-content").html("")}))}})}(jQuery);var editFormData,formData,calendar={};